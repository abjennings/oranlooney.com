---
title: "Your First Two R Packages"
author: "Oran Looney"
date: 2018-06-16
tags: ["R"]
image: /post/r-first-two_files/lead.png
---



<div id="dont-start-with-vanilla" class="section level1">
<h1>Don’t Start With Vanilla!</h1>
<p>It’s natural to assume you should learn the built-in libraries of a new language before moving on to third-party libraries. Unfortunately, when it comes to R, there are few key areas where the built-in functionality is so terrible, and so out-dated, and so full of impossible-to-remember abbreviations, and frankly not very good even once you <em>do</em> learn it, that it’s best to start with a few high quality libraries and treat the built-in functionality as advanced functionalty that you’ll come back and learn when you need to interface with legacy code. Those two areas are:</p>
<ol style="list-style-type: decimal">
<li>Data Manipulation</li>
<li>Visualization</li>
</ol>
<p>Wait a minute, you might say. Aren’t those both fundamental to applied statistics and data mining? If R has such a good reputation, how can it be absolutely terrible at those two things?</p>
<p>Well, it’s really just R’s <em>built-in</em> utilities that are terrible. And not really that terrible in an absolute sense - I’m sure they were killer circa 1990 - just terrible in comparison to modern R packages or other modern frameworks like Pandas. It’s generally accepted in R development that the built-ins are just there for backwards compatability with legacy code (stretching back decades) and to get anything reasonable, you install a package.</p>
<p>There are actually multiple options for improving R’s built-in <code>data.frame</code>, but the one I recommend is <code>dplyr</code>, which actually comes bundled in a package called the <code>tidyverse</code> containing many useful utilities.</p>
<pre class="r"><code>mw_race &lt;- midwest %&gt;% 
  transmute(
    state, 
    county, 
    #popwhite = popwhite / poptotal, 
    popblack = popblack / poptotal, 
    popamerindian = popamerindian / poptotal, 
    popasian = popasian / poptotal, 
    popother = popother / poptotal
  ) %&gt;%
  gather(race, pop, -state, -county)</code></pre>
<p>We can also form some nice plots:</p>
<pre class="r"><code>ggplot(mw_race, aes(race, pop, fill=race)) + 
  scale_y_log10(
    labels = scales::percent) +
  geom_boxplot()
## Warning: Transformation introduced infinite values in continuous y-axis
## Warning: Removed 5 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="/post/r-first-two_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>ggplot(midwest, aes(x=percblack/100, y=percbelowpoverty/100)) +
  scale_x_log10(breaks=c(0.0001, 0.001, 0.01, 0.1, 1, 10, 100), labels = scales::percent) +
  scale_y_continuous(labels = scales::percent) + 
  geom_point(aes(size=log(poptotal), col=state, alpha=0.5)) + 
  scale_size(range=c(0.5, 4)) +
  geom_smooth(method=&quot;lm&quot;) +
  labs(title=&quot;Poverty Line and Race&quot;, x=&quot;Black Population (%)&quot;, y=&quot;Below Poverty Line (%)&quot;)
## Warning: Transformation introduced infinite values in continuous x-axis

## Warning: Transformation introduced infinite values in continuous x-axis
## Warning: Removed 1 rows containing non-finite values (stat_smooth).</code></pre>
<p><img src="/post/r-first-two_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>One handy utility actually visualizes an entire <code>data.frame</code> and all pairwise interactions between columns:</p>
<pre class="r"><code>GGally::ggpairs(iris, mapping=ggplot2::aes(color=Species, alpha=0.5))
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/post/r-first-two_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>This is more than just a pretty picture: it tells you almost everything you would need to know about the distribution of each column (along the diagonal) as well as giving you <em>two</em> separate visual representations of the relationship between each pair of variables. Usually you get a correlation in the upper triangle and a scatter plot in the lower triangle of the matrix, but <code>ggpairs()</code> is also aware of which data types are categorical factors and will use an appropriate visualization, such as a bar chart or boxplot, to help pack as much useful information into one grid as in mechanically possible.</p>
</div>
